<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ejercicio 1</title>
    <!-- Esto es para poder usar el JQuery, debe estar en el head -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</head>

<body>
    <!-- Encabezado -->
    <h1>Ejercicio 1: RETO</h1>

    <!-- Crea un botón, al pulsarlo ejecuta la función ejercicio1() -->
    <p>
        <button onclick="ejercicio1()">Pulsa y observa cómo se rellena la tabla</button>
    </p>

    <table border="1">
        <thead>
            <tr>
                <th>Nombre</th>
                <th>Apellidos</th>
                <th>Ciudad</th>
                <th>Nombre</th>
            </tr>
        </thead>
        <tbody id="nueva-fila">
        </tbody>
    </table>

    <!-- Contenedor div para mostrar resultados en la consola -->
    <div>
        <script>

            // Función que se ejecutará al pulsar el botón
            function ejercicio1() {

                // Creación del objeto "persona"
                let persona = {
                    nombre: "Jesús",
                    apellidos: "García Pereira",
                    edad: 33,
                    ciudad: "Sevilla"
                }

                // Creamos un objeto, llamando a toJSON() será el objeto "persona" en formato JSON
                let personaJSON = toJSON(persona);
                // Mostramos dicho objeto por consola
                console.log(personaJSON);
                // SALIDA: {"nombre":"Jesús","apellidos":"García Pereira","edad":33,"ciudad":"Sevilla"}

                // Creamos un objeto, llamando a toObject() será el objeto "personaJSON" desesializado
                let recuperado = toObject(personaJSON);
                // Mostramos dicho objeto por consola
                console.log(recuperado);
                /* SALIDA: Object { nombre: "Jesús", apellidos: "García Pereira", edad: 33, ciudad: "Sevilla" }
                            apellidos: "García Pereira"
                            ciudad: "Sevilla"
                            edad: 33
                            nombre: "Jesús"   */

                // Creamos un objeto, llamando a generaTr() con el objeto correspondiente
                let recuperadoTr = generaTr(recuperado)
                // Agregamos contenido llamando al método append() con el objeto anterior, dentro del elemento con el id "nueva-fila"
                $("#nueva-fila").append(recuperadoTr);

            }

            // Función para convertir un objeto a formato JSON
            function toJSON(objeto) {
                // Devuelve el objeto del parámetro en formato JSON y serializado (stringify)
                return JSON.stringify(objeto);
            }

            // Función para convertir una cadena JSON a un objeto JavaScript
            function toObject(json) {
                // Devuelve el objeto del parámetro en formato JSON y deserializado (parse)
                return JSON.parse(json);
            }

            // Función que genera una fila de tabla con los elementos del objeto correspondiente
            function generaTr(objeto) {
                return "<tr>" +
                    "<td>" + objeto.nombre + "</td>" +
                    "<td>" + objeto.apellidos + "</td>" +
                    "<td>" + objeto.edad + "</td>" +
                    "<td>" + objeto.ciudad + "</td>" +
                    "</tr>";
            }

        </script>
    </div>
</body>

</html>